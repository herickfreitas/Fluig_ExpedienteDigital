USE [Corporerm]
GO

/****** Object:  View [dbo].[_Fluig_COLABORADORES]    Script Date: 14/09/2021 10:49:41 ******/
SET ANSI_NULLS OFF
GO

SET QUOTED_IDENTIFIER OFF
GO



ALTER VIEW [dbo].[_Fluig_COLABORADORES] AS

SELECT * FROM (

			SELECT PPESSOA.NOME AS COLABORADOR, LOWER(PPESSOA.CODUSUARIO) AS CODUSUARIO, UPPER(PSECAO.DESCRICAO) AS NOME_SECAO, UPPER(PFUNCAO.NOME) AS NOME_FUNCAO,
			
			LOWER(CHEFE.CODUSUARIO) AS CODUSUARIO_CHEFE, CHEFE.NOME AS CHEFE
							FROM PFUNC
							JOIN	PSECAO			ON (PFUNC.CODSECAO=PSECAO.CODIGO)
							JOIN	PFUNCAO			ON (PFUNC.CODFUNCAO=PFUNCAO.CODIGO)
							JOIN	PPESSOA			ON (PFUNC.CODPESSOA=PPESSOA.CODIGO)
							JOIN	GCCUSTO			ON (PSECAO.NROCENCUSTOCONT=GCCUSTO.CODCCUSTO)
							JOIN	PPESSOA CHEFE   ON (GCCUSTO.RESPONSAVEL=CHEFE.CODIGO)
							WHERE 	CODSITUACAO		<> 'D'
				)T1

WHERE T1.CODUSUARIO IS NOT NULL 

GO


